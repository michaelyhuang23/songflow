
torch.Size([32, 491, 1008]) torch.Size([32, 491]) torch.Size([32, 491])
Traceback (most recent call last):
  File "/Users/yh_huang/ProjectData/songflow/transformer_flow/train.py", line 51, in <module>
    loss = -flow.log_prob(batch).mean()
            ^^^^^^^^^^^^^^^^^^^^
  File "/Users/yh_huang/venv/songflow/lib/python3.11/site-packages/nflows/distributions/base.py", line 40, in log_prob
    return self._log_prob(inputs, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yh_huang/venv/songflow/lib/python3.11/site-packages/nflows/flows/base.py", line 39, in _log_prob
    noise, logabsdet = self._transform(inputs, context=embedded_context)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yh_huang/venv/songflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yh_huang/venv/songflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yh_huang/venv/songflow/lib/python3.11/site-packages/nflows/transforms/base.py", line 56, in forward
    return self._cascade(inputs, funcs, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yh_huang/venv/songflow/lib/python3.11/site-packages/nflows/transforms/base.py", line 50, in _cascade
    outputs, logabsdet = func(outputs, context)
                         ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yh_huang/venv/songflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yh_huang/venv/songflow/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yh_huang/venv/songflow/lib/python3.11/site-packages/nflows/transforms/autoregressive.py", line 39, in forward
    outputs, logabsdet = self._elementwise_forward(inputs, autoregressive_params)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yh_huang/ProjectData/songflow/transformer_flow/model.py", line 50, in _elementwise_forward
    outputs = scale * inputs + shift
              ~~~~~~^~~~~~~~
RuntimeError: The size of tensor a (491) must match the size of tensor b (1008) at non-singleton dimension 2